w P.$bP(window,"mouseup")),ve=this.k,Se=Y.pageX,Ae=this.m,pe=Y.pageY;this.a.grab.classList.add("grabbing");const Le=this.a.root.style.transition;this.a.root.style.transition="unset";const Pe=Ve=>{const je=Ve.pageX-Se;this.k=ve-je;const ze=Ve.pageY-pe;this.m=Ae+ze,this.layout()};J.add(oe.event(Pe)),J.add($e.event(Ve=>{Pe(Ve),this.a.grab.classList.remove("grabbing"),this.a.root.style.transition=Le,J.dispose()}))}));const _=this.B(b.Event.chain(this.B(new P.$bP(this.a.grab,"keydown")).event)).map(Y=>new i.$oN(Y)).event;this.B(_(Y=>{let J,oe;if(Y.keyCode===15?J=Number.POSITIVE_INFINITY:Y.keyCode===17?J=0:Y.keyCode===10&&(J=this.k===0?Number.POSITIVE_INFINITY:0),Y.keyCode===16?oe=0:Y.keyCode===18&&(oe=Number.POSITIVE_INFINITY),J!==void 0&&(Y.preventDefault(),Y.stopPropagation(),this.k=J,this.layout()),oe!==void 0){Y.preventDefault(),Y.stopPropagation(),this.m=oe;const $e=this.a.root.style.transition;this.a.root.style.transition="unset",this.layout(),setTimeout(()=>{this.a.root.style.transition=$e},0)}})),this.onDidChangeValue=this.f.onDidChange}getHistory(){return this.f.inputBox.getHistory()}focus(){this.f.focus()}select(){this.f.select(),this.f.inputBox.addToHistory(!0)}layout(o=this.j){this.j=o,this.k=(0,d.$pl)(this.k,0,Math.max(0,o-212)),this.a.root.style.right=`${this.k}px`,this.m=(0,d.$pl)(this.m,0,24),this.a.root.style.top=`${this.m}px`}showMessage(o){this.f.showMessage(o)}clearMessage(){this.f.clearMessage()}async dispose(){this._onDidDisable.fire(),this.a.root.classList.add("disabled"),await(0,a.$sg)(300),super.dispose()}}class Ie{get pattern(){return this.b}get mode(){return this.d}set mode(o){o!==this.d&&(this.d=o,this.g&&(this.g.mode=this.d),this.t.refilter(),this.A(),this.k.fire(o))}get matchType(){return this.f}set matchType(o){o!==this.f&&(this.f=o,this.g&&(this.g.matchType=this.f),this.t.refilter(),this.A(),this.m.fire(o))}constructor(o,C,x,te,A,F={}){this.t=o,this.u=x,this.v=te,this.w=A,this.x=F,this.b="",this.c="",this.j=0,this.k=new b.$5c,this.onDidChangeMode=this.k.event,this.m=new b.$5c,this.onDidChangeMatchType=this.m.event,this.o=new b.$5c,this.onDidChangePattern=this.o.event,this.p=new b.$5c,this.onDidChangeOpenState=this.p.event,this.q=new N.$jb,this.s=new N.$jb,this.d=o.options.defaultFindMode??le.Highlight,this.f=o.options.defaultFindMatchType??ye.Fuzzy,C.onDidSplice(this.z,this,this.s)}updateOptions(o={}){o.defaultFindMode!==void 0&&(this.mode=o.defaultFindMode),o.defaultFindMatchType!==void 0&&(this.matchType=o.defaultFindMatchType)}open(){if(this.g){this.g.focus(),this.g.select();return}this.g=new Fe(this.u.getHTMLElement(),this.t,this.w,this.mode,this.matchType,{...this.x,history:this.a}),this.q.add(this.g),this.g.onDidChangeValue(this.y,this,this.q),this.g.onDidChangeMode(o=>this.mode=o,void 0,this.q),this.g.onDidChangeMatchType(o=>this.matchType=o,void 0,this.q),this.g.onDidDisable(this.close,this,this.q),this.g.layout(this.j),this.g.focus(),this.g.value=this.c,this.g.select(),this.p.fire(!0)}close(){this.g&&(this.a=this.g.getHistory(),this.g=void 0,this.q.dispose(),this.q=new N.$jb,this.c=this.pattern,this.y(""),this.t.domFocus(),this.p.fire(!1))}y(o){this.b=o,this.o.fire(o),this.v.pattern=o,this.t.refilter(),o&&this.t.focusNext(0,!0,void 0,x=>!p.FuzzyScore.isDefault(x.filterData));const C=this.t.getFocus();if(C.length>0){const x=C[0];this.t.getRelativeTop(x)===null&&this.t.reveal(x,.5)}this.A()}z(){!this.g||this.pattern.length===0||(this.t.refilter(),this.A())}A(){const o=this.v.totalCount>0&&this.v.matchCount===0;this.pattern&&o?this.t.options.showNotFoundMessage??!0?this.g?.showMessage({type:2,content:(0,I.localize)(6,null)}):this.g?.showMessage({type:2}):this.g?.clearMessage()}shouldAllowFocus(o){return!this.g||!this.pattern||this.d===le.Filter||this.v.totalCount>0&&this.v.matchCount<=1?!0:!p.FuzzyScore.isDefault(o.filterData)}layout(o){this.j=o,this.g?.layout(o)}dispose(){this.a=void 0,this.o.dispose(),this.q.dispose(),this.s.dispose()}}function Re(U){let o=r.TreeMouseEventTarget.Unknown;return(0,E.$ZN)(U.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?o=r.TreeMouseEventTarget.Twistie:(0,E.$ZN)(U.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?o=r.TreeMouseEventTarget.Element:(0,E.$ZN)(U.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(o=r.TreeMouseEventTarget.Filter),{browserEvent:U.browserEvent,element:U.element?U.element.element:null,target:o}}function he(U){return{element:U.element?U.element.element:null,browserEvent:U.browserEvent,anchor:U.anchor}}function ie(U,o){o(U),U.children.forEach(C=>ie(C,o))}class K{get f(){return this.d||(this.d=this.m()),this.d}constructor(o,C){this.g=o,this.j=C,this.a=[],this.c=new b.$5c,this.onDidChange=this.c.event}set(o,C){!C?.__forceEvent&&(0,e.$$e)(this.a,o)||this.k(o,!1,C)}k(o,C,x){if(this.a=[...o],this.b=void 0,this.d=void 0,!C){const te=this;this.c.fire({get elements(){return te.get()},browserEvent:x})}}get(){return this.b||(this.b=this.a.map(o=>o.element)),[...this.b]}getNodes(){return this.a}has(o){return this.f.has(o)}onDidModelSplice({insertedNodes:o,deletedNodes:C}){if(!this.j){const $=this.m(),j=B=>$.delete(B);C.forEach(B=>ie(B,j)),this.set([...$.values()]);return}const x=new Set,te=$=>x.add(this.j.getId($.element).toString());C.forEach($=>ie($,te));const A=new Map,F=$=>A.set(this.j.getId($.element).toString(),$);o.forEach($=>ie($,F));const R=[];for(const $ of this.a){const j=this.j.getId($.element).toString();if(!x.has(j))R.push($);else{const O=A.get(j);O&&O.visible&&R.push(O)}}if(this.a.length>0&&R.length===0){const $=this.g();$&&R.push($)}this.k(R,!0)}m(){const o=new Set;for(const C of this.a)o.add(C);return o}}class W extends u.$yP{constructor(o,C){super(o),this.z=C}u(o){if((0,u.$uP)(o.browserEvent.target)||(0,u.$sP)(o.browserEvent.target)||(0,u.$tP)(o.browserEvent.target)||o.browserEvent.isHandledByList)return;const C=o.element;if(!C)return super.u(o);if(this.p(o)||this.o(o))return super.u(o);const x=o.browserEvent.target,te=x.classList.contains("monaco-tl-twistie")||x.classList.contains("monaco-icon-label")&&x.classList.contains("folder-icon")&&o.browserEvent.offsetX<16;let A=!1;if(typeof this.z.expandOnlyOnTwistieClick=="function"?A=this.z.expandOnlyOnTwistieClick(C.element):A=!!this.z.expandOnlyOnTwistieClick,A&&!te&&o.browserEvent.detail!==2)return super.u(o);if(!this.z.expandOnDoubleClick&&o.browserEvent.detail===2)return super.u(o);if(C.collapsible){const F=this.z.getNodeLocation(C),R=o.browserEvent.altKey;if(this.z.setFocus([F]),this.z.toggleCollapsed(F,R),A&&te){o.browserEvent.isHandledByList=!0;return}}super.u(o)}v(o){o.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.z.expandOnDoubleClick||o.browserEvent.isHandledByList||super.v(o)}}class q extends u.$BP{constructor(o,C,x,te,A,F,R,$){super(o,C,x,te,$),this.p=A,this.s=F,this.M=R}F(o){return new W(this,o.tree)}splice(o,C,x=[]){if(super.splice(o,C,x),x.length===0)return;const te=[],A=[];let F;x.forEach((R,$)=>{this.p.has(R)&&te.push(o+$),this.s.has(R)&&A.push(o+$),this.M.has(R)&&(F=o+$)}),te.length>0&&super.setFocus((0,e.$of)([...super.getFocus(),...te])),A.length>0&&super.setSelection((0,e.$of)([...super.getSelection(),...A])),typeof F=="number"&&super.setAnchor(F)}setFocus(o,C,x=!1){super.setFocus(o,C),x||this.p.set(o.map(te=>this.element(te)),C)}setSelection(o,C,x=!1){super.setSelection(o,C),x||this.s.set(o.map(te=>this.element(te)),C)}setAnchor(o,C=!1){super.setAnchor(o),C||(typeof o>"u"?this.M.set([]):this.M.set([this.element(o)]))}}class D{get onDidScroll(){return this.j.onDidScroll}get onDidChangeFocus(){return this.w.wrapEvent(this.p.onDidChange)}get onDidChangeSelection(){return this.w.wrapEvent(this.q.onDidChange)}get onMouseClick(){return b.Event.map(this.j.onMouseClick,Re)}get onMouseDblClick(){return b.Event.filter(b.Event.map(this.j.onMouseDblClick,Re),o=>o.target!==r.TreeMouseEventTarget.Filter)}get onContextMenu(){return b.Event.map(this.j.onContextMenu,he)}get onTap(){return b.Event.map(this.j.onTap,Re)}get onPointer(){return b.Event.map(this.j.onPointer,Re)}get onKeyDown(){return this.j.onKeyDown}get onKeyUp(){return this.j.onKeyUp}get onKeyPress(){return this.j.onKeyPress}get onDidFocus(){return this.j.onDidFocus}get onDidBlur(){return this.j.onDidBlur}get onDidChangeModel(){return b.Event.signal(this.o.onDidSplice)}get onDidChangeCollapseState(){return this.o.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.o.onDidChangeRenderNodeCount}get findMode(){return this.x?.mode??le.Highlight}set findMode(o){this.x&&(this.x.mode=o)}get findMatchType(){return this.x?.matchType??ye.Fuzzy}set findMatchType(o){this.x&&(this.x.matchType=o)}get onDidChangeFindPattern(){return this.x?this.x.onDidChangePattern:b.Event.None}get expandOnDoubleClick(){return typeof this.E.expandOnDoubleClick>"u"?!0:this.E.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this.E.expandOnlyOnTwistieClick>"u"?!0:this.E.expandOnlyOnTwistieClick}get onDidDispose(){return this.j.onDidDispose}constructor(o,C,x,te,A={}){this.D=o,this.E=A,this.w=new b.$_c,this.onDidChangeFindOpenState=b.Event.None,this.A=new N.$jb,this.B=new b.$5c,this.onWillRefilter=this.B.event,this.C=new b.$5c,this.onDidUpdateOptions=this.C.event;const F=new L(x),R=new b.$ad,$=new b.$ad,j=this.A.add(new G($.event)),B=new s.$L;this.k=te.map(Y=>new ne(Y,()=>this.o,R.event,j,B,A));for(const Y of this.k)this.A.add(Y);let O;A.keyboardNavigationLabelProvider&&(O=new se(this,A.keyboardNavigationLabelProvider,A.filter),A={...A,filter:O},this.A.add(O)),this.p=new K(()=>this.j.getFocusedElements()[0],A.identityProvider),this.q=new K(()=>this.j.getSelectedElements()[0],A.identityProvider),this.u=new K(()=>this.j.getAnchorElement(),A.identityProvider),this.j=new q(o,C,F,this.k,this.p,this.q,this.u,{...S(()=>this.o,A),tree:this}),this.o=this.I(o,this.j,A),R.input=this.o.onDidChangeCollapseState;const _=b.Event.forEach(this.o.onDidSplice,Y=>{this.w.bufferEvents(()=>{this.p.onDidModelSplice(Y),this.q.onDidModelSplice(Y)})},this.A);if(_(()=>null,null,this.A),$.input=b.Event.chain(b.Event.any(_,this.p.onDidChange,this.q.onDidChange)).debounce(()=>null,0).map(()=>{const Y=new Set;for(const J of this.p.getNodes())Y.add(J);for(const J of this.q.getNodes())Y.add(J);return[...Y.values()]}).event,A.keyboardSupport!==!1){const Y=b.Event.chain(this.j.onKeyDown).filter(J=>!(0,u.$sP)(J.target)).map(J=>new i.$oN(J));Y.filter(J=>J.keyCode===15).on(this.F,this,this.A),Y.filter(J=>J.keyCode===17).on(this.G,this,this.A),Y.filter(J=>J.keyCode===10).on(this.H,this,this.A)}if((A.findWidgetEnabled??!0)&&A.keyboardNavigationLabelProvider&&A.contextViewProvider){const Y=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.x=new Ie(this,this.o,this.j,O,A.contextViewProvider,Y),this.y=J=>this.x.shouldAllowFocus(J),this.onDidChangeFindOpenState=this.x.onDidChangeOpenState,this.A.add(this.x),this.onDidChangeFindMode=this.x.onDidChangeMode,this.onDidChangeFindMatchType=this.x.onDidChangeMatchType}else this.onDidChangeFindMode=b.Event.None,this.onDidChangeFindMatchType=b.Event.None;this.z=(0,E.$5N)(this.j.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this.E.renderIndentGuides===H.Always)}updateOptions(o={}){this.E={...this.E,...o};for(const C of this.k)C.updateOptions(o);this.j.updateOptions(this.E),this.x?.updateOptions(o),this.C.fire(this.E),this.getHTMLElement().classList.toggle("always",this.E.renderIndentGuides===H.Always)}get options(){return this.E}updateWidth(o){const C=this.o.getListIndex(o);C!==-1&&this.j.updateWidth(C)}getHTMLElement(){return this.j.getHTMLElement()}get contentHeight(){return this.j.contentHeight}get contentWidth(){return this.j.contentWidth}get onDidChangeContentHeight(){return this.j.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.j.onDidChangeContentWidth}get scrollTop(){return this.j.scrollTop}set scrollTop(o){this.j.scrollTop=o}get scrollLeft(){return this.j.scrollLeft}set scrollLeft(o){this.j.scrollLeft=o}get scrollHeight(){return this.j.scrollHeight}get renderHeight(){return this.j.renderHeight}get firstVisibleElement(){const o=this.j.firstVisibleIndex;return o<0||o>=this.j.length?void 0:this.j.element(o).element}get lastVisibleElement(){const o=this.j.lastVisibleIndex;return this.j.element(o).element}get ariaLabel(){return this.j.ariaLabel}set ariaLabel(o){this.j.ariaLabel=o}get selectionSize(){return this.q.getNodes().length}domFocus(){this.j.domFocus()}isDOMFocused(){return this.getHTMLElement()===document.activeElement}layout(o,C){this.j.layout(o,C),(0,v.$ke)(C)&&this.x?.layout(C)}style(o){const C=`.${this.j.domId}`,x=[];o.treeIndentGuidesStroke&&(x.push(`.monaco-list${C}:hover .monaco-tl-indent > .indent-guide, .monaco-list${C}.always .monaco-tl-indent > .indent-guide  { border-color: ${o.treeInactiveIndentGuidesStroke}; }`),x.push(`.monaco-list${C} .monaco-tl-indent > .indent-guide.active { border-color: ${o.treeIndentGuidesStroke}; }`)),this.z.textContent=x.join(`
`),this.j.style(o)}getParentElement(o){const C=this.o.getParentNodeLocation(o);return this.o.getNode(C).element}getFirstElementChild(o){return this.o.getFirstElementChild(o)}getNode(o){return this.o.getNode(o)}getNodeLocation(o){return this.o.getNodeLocation(o)}collapse(o,C=!1){return this.o.setCollapsed(o,!0,C)}expand(o,C=!1){return this.o.setCollapsed(o,!1,C)}toggleCollapsed(o,C=!1){return this.o.setCollapsed(o,void 0,C)}expandAll(){this.o.setCollapsed(this.o.rootRef,!1,!0)}collapseAll(){this.o.setCollapsed(this.o.rootRef,!0,!0)}isCollapsible(o){return this.o.isCollapsible(o)}setCollapsible(o,C){return this.o.setCollapsible(o,C)}isCollapsed(o){return this.o.isCollapsed(o)}triggerTypeNavigation(){this.j.triggerTypeNavigation()}openFind(){this.x?.open()}closeFind(){this.x?.close()}refilter(){this.B.fire(void 0),this.o.refilter()}setAnchor(o){if(typeof o>"u")return this.j.setAnchor(void 0);const C=this.o.getNode(o);this.u.set([C]);const x=this.o.getListIndex(o);x>-1&&this.j.setAnchor(x,!0)}getAnchor(){return(0,e.$sf)(this.u.get(),void 0)}setSelection(o,C){const x=o.map(A=>this.o.getNode(A));this.q.set(x,C);const te=o.map(A=>this.o.getListIndex(A)).filter(A=>A>-1);this.j.setSelection(te,C,!0)}getSelection(){return this.q.get()}setFocus(o,C){const x=o.map(A=>this.o.getNode(A));this.p.set(x,C);const te=o.map(A=>this.o.getListIndex(A)).filter(A=>A>-1);this.j.setFocus(te,C,!0)}focusNext(o=1,C=!1,x,te=this.y){this.j.focusNext(o,C,x,te)}focusPrevious(o=1,C=!1,x,te=this.y){this.j.focusPrevious(o,C,x,te)}focusNextPage(o,C=this.y){return this.j.focusNextPage(o,C)}focusPreviousPage(o,C=this.y){return this.j.focusPreviousPage(o,C)}focusLast(o,C=this.y){this.j.focusLast(o,C)}focusFirst(o,C=this.y){this.j.focusFirst(o,C)}getFocus(){return this.p.get()}reveal(o,C){this.o.expandTo(o);const x=this.o.getListIndex(o);x!==-1&&this.j.reveal(x,C)}getRelativeTop(o){const C=this.o.getListIndex(o);return C===-1?null:this.j.getRelativeTop(C)}getViewState(o=this.options.identityProvider){if(!o)throw new r.$aR(this.D,"Can't get tree view state without an identity provider");const C=F=>o.getId(F).toString(),x=k.empty(this.scrollTop);for(const F of this.getFocus())x.focus.add(C(F));for(const F of this.getSelection())x.selection.ad